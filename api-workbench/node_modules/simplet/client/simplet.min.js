// simpleT 0.2.1 (client-side)
//
// Copyright 2012-2015, Micleusanu Nicu
//
// This source code is licensed under GPLv3 license

var simplet=function(a){"use strict";var b=function(a){var b="%>",c=!1,d="ejs",e={},f="<%";a&&"object"==typeof a||(a={}),a.open&&"string"==typeof a.open&&(f=a.open),a.close&&"string"==typeof a.close&&(b=a.close),a.extension&&"string"==typeof a.extension&&(d=a.extension),a.debug===!0&&(c=!0),a.globals&&"object"==typeof a.globals&&Object.keys(a.globals).forEach(function(b){e[b]=a.globals[b]}),Object.defineProperties(this,{close:{value:b},container:{value:{}},debug:{value:c},extension:{value:d},globals:{value:e},open:{value:f}})};return b.escapeXMLChars={'"':"&quot;","&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;"},b.escapeXMLRe=/[&<>'"]/g,b.escapeXML=function(a){return a.replace(b.escapeXMLRe,function(a){return b.escapeXMLChars[a]})},b.catchError=function(a,b,c){var d=0,e=a.original,f="Template Error\n",g=0;return b?(f+=a.location+":"+(c.line+1)+"\n\n",c instanceof SyntaxError||(g=Math.max(0,Math.min(c.line-2,e.length-5)),d=Math.min(g+5,e.length),f+=e.slice(g,d).map(function(a,b){var e=g+b,f=String(e+1);return f.length<String(d).length&&(f=" "+f),f=e===c.line?"> "+f:"  "+f,f+" | "+a.slice(0,80-f.length)}).join("\n")+"\n\n"),f+=c.stack?c.stack:c.name+": "+c.message):f+="enable debug mode for expanded result",f},b.normalizePath=function(a,b){for(var c="/"===a[0],d=0,e=a.split("/"),f=e[0],g=e.length,h=[],i=a&&"/"===a[a.length-1];g>d;)f&&"."!==f&&(".."===f?h.length&&".."!==h[h.length-1]?h.pop():c||h.push(".."):h.push(f)),d++,f=e[d];return a=h.join("/"),a||c||(a="."),a&&i&&(a+="/"),c&&(a="/"+a),a.substr(-b.length-1)!=="."+b&&(a+="."+b),a},b.prototype.clear=function(a){a&&"string"==typeof a&&delete this.container[a]},b.prototype.render=function(a,c){var d=[],e={},f=this.extension,g=this.globals,h=null,i="",j=null,k=this,l=[];e.include=function(d){"/"!==d[0]&&(d=a.substr(0,a.lastIndexOf("/")+1)+d),d=b.normalizePath(d,f),i+=k.render(d,c)},e.print=function(){for(var a=0,b=arguments.length;b>a;)i+="string"==typeof arguments[a]?arguments[a]:void 0===arguments[a]?"":JSON.stringify(arguments[a]),a++},e.printx=function(){for(var a=0,c=arguments.length;c>a;)i+="string"==typeof arguments[a]?b.escapeXML(arguments[a]):void 0===arguments[a]?"":b.escapeXML(JSON.stringify(arguments[a])),a++},c&&"object"==typeof c||(c={});for(h in g)c[h]||e[h]||("function"==typeof g[h]?e[h]=g[h].bind(e):e[h]=g[h]);for(h in c)e[h]||("function"==typeof c[h]?e[h]=c[h].bind(e):e[h]=c[h]);for(h in e)d.push(h),l.push(e[h]);if(j=this.container[b.normalizePath(a,f)])try{Function(d,j.compiled).apply(e,l)}catch(m){i=b.catchError(j,this.debug,m)}else i=this.debug?'Template "'+a+'" was not found':"Template not found";return i},b.prototype.template=function(a,c){var d="",e=this.close,f=e.length,g=c[0],h=0,i=0,j=this.open,k=j.length,l="",m=!1,n=!1;for(this.debug&&(l+="var _l_=0;try{");g;){if(c.substr(h,k)===j){for(h+=k,g=c[h],d&&(l+="print('"+d+"');",d=""),this.debug&&i>0&&(l+="_l_="+i+";"),"-"===g||"="===g||"@"===g?("-"===g?l+="print(":"="===g?l+="printx(":"@"===g&&(l+="include("),n=!0,h++,g=c[h]):"#"===g&&(m=!0,h++,g=c[h]);g&&c.substr(h,f)!==e;)["\n","\r","\u2028","\u2029"].indexOf(g)>=0?(this.debug&&i++,"\r"===g&&"\n"===c[h+1]&&h++,m||(d+="\n")):m||(d+=g),h++,g=c[h];l+=d.trim(),n?(l+=");",n=!1):m?m=!1:l+="\n",h+=f,d=""}else["\n","\r","\u2028","\u2029"].indexOf(g)>=0?(this.debug&&i++,d+="\\n","\r"===g&&"\n"===c[h+1]&&h++):(("'"===g||"\\"===g)&&(d+="\\"),d+=g),h++;g=c[h]}d&&(l+="print('"+d+"');",d=""),l=l.trim(),this.debug&&(l+="}catch(e){e.line=_l_;throw e}"),a=b.normalizePath(a,this.extension),this.container[a]={compiled:l,location:a,original:c.split(/\r\n|\n|\r|\u2028|\u2029/)}},new b(a)};